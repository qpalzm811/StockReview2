提示词一：生成基础量化因子库（价量、动量、反转）

Role: 你是一名精通 Python 的量化金融开发工程师，擅长使用 Pandas, NumPy 和 TA-Lib 编写高胜率的技术分析因子。
Task: 请帮我编写一个 Python 类 TechnicalFactors，该类接收一个包含 'Open', 'High', 'Low', 'Close', 'Volume' 的 Pandas DataFrame，并计算以下因子：
CorrPV (量价相关性): 计算过去 20 个交易日 Close 与 Volume 的皮尔逊相关系数。
VWAP_Dev (VWAP 偏离度): 计算 (Close - VWAP) / VWAP。其中 VWAP 为当日成交量加权平均价。
RSquared (趋势线性度): 对过去 20 日收盘价进行线性回归，返回其 R^2 值，用于衡量趋势的平滑程度。
Sharpe_Momentum (波动调整动量): 计算过去 20 日收益率的均值除以标准差（即 Mean(Returns) / Std(Returns)）。
KDJ_RSI_Coincidence (低位共振):
计算 KDJ(9,3,3) 和 RSI(6)。
当 K < 20, D < 20 且 RSI < 30 时，输出信号 1，否则为 0。
Boll_Bandwidth (布林带缩放): 计算 (Upper_Band - Lower_Band) / Middle_Band，用于捕捉波动率挤压。
Requirement:
请使用向量化计算（Vectorized operations）以提高运行速度。
处理好因子的空值（NaN），并在代码中加入简要注释。
输出结果应作为新的列添加到原 DataFrame 中。

因子排名归一化 (Rank Normalization)： 在复盘时，不要看因子的绝对值，要看该因子在整个股票池中的百分比排名（0-1）。
IC分布分析： 在复盘界面显示该因子在过去12个月的信息系数 (IC)，如果IC近期剧烈波动，说明该因子在当前行情下失效。
多因子打分池： 推荐将 趋势线性度 + 量价相关性 + 波动率调整动量 组合成一个“综合择时得分”，只有得分超过0.8时才在K线上标注买入信号。